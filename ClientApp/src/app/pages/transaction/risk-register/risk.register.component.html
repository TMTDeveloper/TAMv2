<nb-card>
  <nb-card-header>Risk Register</nb-card-header>
  <nb-card-body>
    <div class="form-group">
      <div class="col-sm-2">
        <label>Year</label>
        <input type="text" class="form-control" [(ngModel)]="yearPeriode" disabled="true">
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-3">
        <label>Risk No</label>
        <input type="text" class="form-control" ngModel name="riskno">
      </div>
    </div>

    <!-- <div class="col-sm-auto row">
        <div class="col-sm-auto">
          <div class="form-group">
            <button type="submit" class="btn btn-success ">Submit</button>
          </div>
        </div>
        <div class="col-sm-auto">
          <div class="form-group">
            <button type="button" class="btn btn-success ">Add New</button>
          </div>
        </div>
      </div> -->
    <div class="col-sm-auto">
      <nb-tabset>
        <nb-tab tabTitle="Division/Department">
          <div class="form-group row">
            <label for="division" class="col-sm-2 col-form-label">Division</label>
            <div class="col-sm-4">
              <input type="text" class="form-control" id="division" [(ngModel)]="dataInput.divisionDepartment.division.desc">
            </div>
          </div>
          <div class="form-group row">
            <label for="department" class="col-sm-2 col-form-label">Department</label>
            <div class="col-sm-4">
              <input type="text" class="form-control" id="department" [(ngModel)]="dataInput.divisionDepartment.department.desc">
            </div>
          </div>

          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Company KPI</label>
            <div class="col-lg-6">
              <button class="btn btn-success with-margins" (click)="showModal()">LOV</button>
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>

            </div>
            <div class="col-sm-12">
              <textarea disabled="true" rows="3" type="text" class="form-control" [(ngModel)]="dataInput.divisionDepartment.companyKpi.description"></textarea>
            </div>
          </div>


          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Department KPI</label>
            <div class="col-lg-6">
              <button class="btn btn-success with-margins" (click)="showDept()">LOV</button>
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-12">
              <textarea rows="3" type="text" class="form-control" [(ngModel)]="dataInput.divisionDepartment.departmentKpi.description"
                disabled="true"></textarea>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Business Process</label>
            <div class="col-lg-6">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-12">
              <textarea rows="3" type="text" class="form-control" [(ngModel)]="dataInput.divisionDepartment.businessProcess"></textarea>
            </div>
          </div>
        </nb-tab>
        <nb-tab tabTitle="Risk Description">
          <div class="form-group row mt-3">
            <label class="col-sm-2 col-form-label">Loss Event</label>
            <div class="col-lg-6">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-12">
              <textarea rows="3" type="text" class="form-control" [(ngModel)]="dataInput.riskDescription.lossEvent"></textarea>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Caused</label>
            <div class="col-lg-6">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-12">
              <textarea rows="3" type="text" class="form-control" [(ngModel)]="dataInput.riskDescription.caused"></textarea>
            </div>
          </div>
          <div class="form-group row ">
            <label class="col-sm-2 col-form-label">Risk Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select multiple class="form-control" name="risk_impact" [(ngModel)]="dataInput.riskDescription.riskImpact">
                <option *ngFor="let data of getListRiskIndicator('RTP')" value="{{data.description}}">{{data.description}}</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Risk Level</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" name="risk_level" [(ngModel)]="dataInput.riskDescription.riskLevel">
                <option *ngFor="let data of getListRiskIndicator('LVL')" value="{{data.indicatorId}}">{{data.description}}</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Accident</label>
            <div class="col-lg-6">
              <button class="btn btn-success with-margins" (click)="showAccident()">LOV</button>
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
          </div>
          <div class="col-sm-auto">
            <div class="form-group">
              <ng2-smart-table [settings]="accidentset" [source]="accidentSrc" (deleteConfirm)="deleteAccident($event)">
              </ng2-smart-table>
            </div>
          </div>
        </nb-tab>
        <nb-tab tabTitle="Inherent Risk">
          <div class="form-group row mt-3">
            <label class="col-sm-2 col-form-label">Notes</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-12">
              <textarea rows="3" type="text" class="form-control" [(ngModel)]="dataInput.inherentRisk.notes"></textarea>
            </div>
          </div>
          <div class="form-group row ">
            <label class="col-sm-2 col-form-label">Financial Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" name="risk_impact" [(ngModel)]="dataInput.inherentRisk.financialImpact.category" (change)="findFinancialImpactRisk()">
                <option *ngFor="let data of financialImpact" value="{{data.data}}">{{data.desc}}</option>
              </select>
            </div>
            <label class="col-sm-1 col-form-label">Amount</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input class="form-control" currencyMask [options]="{ prefix: '', thousands: '.', decimal: ',',precision:'0' }" [(ngModel)]="dataInput.inherentRisk.financialImpact.amount"
                (keyup)="findFinancialImpactRisk()">
            </div>
          </div>

          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Operational Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" name="risk_impact" [(ngModel)]="dataInput.inherentRisk.operationalImpact.category" (change)="findOperationalImpactRisk()">
                <option *ngFor="let data of operationalImpact" value="{{data.data}}">{{data.desc}}</option>
              </select>
            </div>
            <label class="col-sm-1 col-form-label">Loss</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input currencyMask [options]="{ prefix: '', thousands: '.', decimal: ',', precision:'0'}" class="form-control" [(ngModel)]="dataInput.inherentRisk.operationalImpact.loss"
                (keyup)="findOperationalImpactRisk()">
            </div>
          </div>

          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Qualitative Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success with-margins" (click)="showQLIR()">LOV</button>
            </div>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-4">
              <input type="text" class="form-control" disabled="true" [(ngModel)]="dataInput.inherentRisk.qualitativeIR.desc">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Overall Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" disabled="true" [(ngModel)]="dataInput.inherentRisk.overallImpact.description">
            </div>
          </div>
          <div class="form-group row ">
            <label class="col-sm-2 col-form-label">Likelihood</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" name="risk_impact" [(ngModel)]="dataInput.inherentRisk.likelihood" (change)="findOverallRisk()">
                <option *ngFor="let data of getListRiskIndicator('LKL')" value="{{data.indicatorId}}">{{data.description}}</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Overall Risk</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" disabled="true" [(ngModel)]="dataInput.inherentRisk.overallRisk.description">
            </div>
          </div>
          <span> </span>
        </nb-tab>
        <nb-tab tabTitle="Current Action / Controls">
          <div class="form-group row mt-3">
            <label class="col-sm-2 col-form-label">Controls</label>
            <div class="col-lg-6">
              <button class="btn btn-success with-margins" (click)="showCtr()">Add New</button>
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
          </div>
          <div class="col-sm-auto">
            <div class="form-group">
              <ng2-smart-table [settings]="controlset" [source]="controlSrc" (deleteConfirm)="deleteControl($event)" (editConfirm)="saveControl($event)">
              </ng2-smart-table>
            </div>
          </div>

          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Operation</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" name="risk_impact" [(ngModel)]="dataInput.currentAction.operation" (change)="findOverallControl()">
                <option *ngFor="let data of getListRiskIndicator('OPR')" value="{{data.indicatorId}}">{{data.description}}</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Appropriateness</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" [(ngModel)]="dataInput.currentAction.appropriateness.description" disabled="true">
            </div>
            <label class="col-sm-2 col-form-label">Overall Control</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" [(ngModel)]="dataInput.currentAction.overallControl.description" disabled="true">
            </div>
          </div>

          <div class="form-group row ">
            <label class="col-sm-1 col-form-label">Preventive</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" [(ngModel)]="dataInput.currentAction.Preventive" disabled="true">
            </div>
            <label class="col-sm-1 col-form-label">Detective</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" [(ngModel)]="dataInput.currentAction.Detective" disabled="true">
            </div>
            <label class="col-sm-1 col-form-label">Corrective</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" [(ngModel)]="dataInput.currentAction.Corrective" disabled="true">
            </div>
          </div>

        </nb-tab>
        <nb-tab tabTitle="Residual Risk">
          <div class="form-group row mt-3">
            <label class="col-sm-2 col-form-label">Notes</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-12">
              <textarea rows="3" type="text" class="form-control" [(ngModel)]="dataInput.residualRisk.notes"></textarea>
            </div>
          </div>
          <div class="form-group row ">
            <label class="col-sm-2 col-form-label">Financial Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" name="risk_impact" [(ngModel)]="dataInput.inherentRisk.financialImpact.category" (change)="findFinancialImpactRiskRd()"
                disabled="true">
                <option *ngFor="let data of financialImpact" value="{{data.data}}">{{data.desc}}</option>
              </select>
            </div>
            <label class="col-sm-1 col-form-label">Amount</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input class="form-control" currencyMask [options]="{ prefix: '', thousands: '.', decimal: ',',precision:'0' }" [(ngModel)]="dataInput.residualRisk.financialImpact.amount"
                (keyup)="findFinancialImpactRiskRd()">
            </div>
          </div>

          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Operational Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" name="risk_impact" [(ngModel)]="dataInput.inherentRisk.operationalImpact.category" (change)="findOperationalImpactRiskRd()"
                disabled="true">
                <option *ngFor="let data of operationalImpact" value="{{data.data}}">{{data.desc}}</option>
              </select>
            </div>
            <label class="col-sm-1 col-form-label">Loss</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input class="form-control" currencyMask [options]="{ prefix: '', thousands: '.', decimal: ',', precision:'0'}" class="form-control"
                [(ngModel)]="dataInput.residualRisk.operationalImpact.loss" (keyup)="findOperationalImpactRiskRd()">
            </div>
          </div>

          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Qualitative Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success with-margins" (click)="showQLRD()">LOV</button>
            </div>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <input type="text" class="form-control" disabled="true" [(ngModel)]="dataInput.residualRisk.qualitativeRD.desc">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Overall Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" disabled="true" [(ngModel)]="dataInput.residualRisk.overallImpact.description">
            </div>
          </div>
          <div class="form-group row ">
            <label class="col-sm-2 col-form-label">Likelihood</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" name="risk_impact" [(ngModel)]="dataInput.residualRisk.likelihood" (change)="findOverallRiskRd()">
                <option *ngFor="let data of getListRiskIndicator('LKL')" value="{{data.indicatorId}}">{{data.description}}</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Overall Risk</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" disabled="true" [(ngModel)]="dataInput.residualRisk.overallRisk.description">
            </div>
          </div>
        </nb-tab>
        <nb-tab tabTitle="Expected Risk">
          <div class="form-group row">
            <nb-checkbox status="success" class="col-sm-4" (change)="treatmentPlanSwitch()" [(ngModel)]="dataInput.expectedRisk.treatmentPlanSwitch"
              disabled="{{dataInput.expectedRisk.disabled}}">Anda setuju tidak diperlukan Treament Plan ?</nb-checkbox>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Treatment Plan</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-12">
              <textarea rows="3" type="text" class="form-control" [(ngModel)]="dataInput.expectedRisk.treatmentPlan" disabled="{{dataInput.expectedRisk.treatmentPlanSwitch}}"></textarea>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Impact</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" [(ngModel)]="dataInput.expectedRisk.impact" (change)="findExpectedRisk()" disabled="{{dataInput.expectedRisk.treatmentPlanSwitch}}">
                <option *ngFor="let data of getListRiskIndicator('IMP')" value="{{data.indicatorId}}">{{data.description}}</option>
              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Likelihood</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-5">
              <select class="form-control" [(ngModel)]="dataInput.expectedRisk.likelihood" (change)="findExpectedRisk()" disabled="{{dataInput.expectedRisk.treatmentPlanSwitch}}">

                <option *ngFor="let data of getListRiskIndicator('LKL')" value="{{data.indicatorId}}">{{data.description}}</option>

              </select>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Risk</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" [(ngModel)]="dataInput.expectedRisk.risk.description" disabled="true">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">PIC</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" [(ngModel)]="dataInput.expectedRisk.PIC" disabled="{{dataInput.expectedRisk.treatmentPlanSwitch}}">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Schedule</label>
            <div class="col-lg-1">
              <button class="btn btn-success btn-round with-margins" nbPopover="Master untuk memasukkan data tahunan financial TAM">?</button>
            </div>
            <div class="col-sm-2">
              <input type="text" class="form-control" [(ngModel)]="dataInput.expectedRisk.schedule" disabled="{{dataInput.expectedRisk.treatmentPlanSwitch}}">
            </div>
          </div>
        </nb-tab>
      </nb-tabset>

      <div class="row mt-2 ml-1">
        <div class="col-sm-auto">
          <button type=" button " class="btn btn-success " (click)="save() ">Save</button>
        </div>
        <div class="col-sm-auto">
          <button type=" button " class="btn btn-success " (click)="save() ">Save As Draft</button>
        </div>
        <div class="col-sm-auto">
          <button type=" button " class="btn btn-success " (click)="save() ">Cancel</button>
        </div>
      </div>

    </div>
  </nb-card-body>
</nb-card>
